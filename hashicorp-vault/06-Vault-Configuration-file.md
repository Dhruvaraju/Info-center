# Configuration File

- Vault configuration files are written in HCL or Json format
- The configuration file includes different stanzas and parameters to define a variety of configuration options.

- To specify the configuration file use `-config` flag when starting vault
```
vault server -config <loation of config file>
```

- Usually configuration files is stored somewhere in /etc folder (We can choose other folder locations as well) example:
```
vault server -config /etc/vault.d/vault.hcl
```

## What is configured in configuration file?

 - Storage Backend
	 - Which storage backend to use, how to access it
 - Listeners and Port
	 - Where can Vault listen for incoming API requests
 - TLS certificate
	 - So traffic can be encrypted in transit
 - Seal type
	 - What seal type is used and its location.
 - Cluster Name
	 - What is the name of the cluster where it is currently residing
 - Log Level
 - UI
	 - Enable or disable 
 - Cluster Ip and Port
	 - Cluster access details and listening port

## What are not configured in Vault

- Secrets Engine
- Authentication Methods
- Audit Devices
- Policies
- Entities and Groups

## How does a configuration file look like

A configuration file will have multiple stanzas and few parameters it appears similar to below example:

```
stanza1 "option"{
<parameter1>= <value1>
<parameter2>= <value2>
}

stanza2 "option"{
<parameter1>= <value1>
<parameter2>= <value2>
}

<parameter1>= <value1>
<parameter2>= <value>
```

Example:
```
listener "tcp"{
address= "0.0.0.0:8200"
cluster_address = "0.0.0.0:8201"
tls_disable= "true" #never do this prod
}

seal "awskms" {
region = "<region>"
kms_key_id="<kms_key>"
}

api_addr = "https://ipaddress:8200"
ui=true
cluster_name="vault_cluster"
```

### Available Stanzas:

-  Seal : seal type
- listener: addresses and ports for vault
- storage: storage backend
- telemetry: where to publish metrics to upstream systems

Example of Parameters:

- Cluster_name: identifier of cluster - Vault with autogenerated name is omitted
- log_level: specifies the log level to use - Trace, Error, Warn, Info
- UI: enables the built in web ui
- api_adr: address to advertise to other vault servers for client redirection
- cluster_addr: address to advertise to other vault servers for request forwarding

**Example Vault Configuration File**

```
storage "consul" {
  address = "127.0.0.1:8500"
  path    = "vault/"
  token   = "1a2b3c4d-1234-abdc-1234-1a2b3c4d5e6a"
}
listener "tcp" {
 address = "0.0.0.0:8200"
 cluster_address = "0.0.0.0:8201"
 tls_disable = 0
 tls_cert_file = "/etc/vault.d/client.pem"
 tls_key_file = "/etc/vault.d/cert.key"
 tls_disable_client_certs = "true"
}
seal "awskms" {
  region = "us-east-1"
  kms_key_id = "12345678-abcd-1234-abcd-123456789101",
  endpoint = "example.kms.us-east-1.vpce.amazonaws.com"
}
api_addr = "https://vault-us-east-1.example.com:8200"
cluster_addr = " https://node-a-us-east-1.example.com:8201"
cluster_name = "vault-prod-us-east-1"
ui = false
log_level = "INFO"
license_path = "/opt/vault/vault.hcl"
```

> [!note] Vault Configuration reference documentation
> https://www.vaultproject.io/docs/configuration
